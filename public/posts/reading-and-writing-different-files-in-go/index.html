<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  class="html"
><head>
  <title>
    
      Jacob Kim
        |
        Reading and Writing Different Files in Go


      


    
  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.101.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Jacob Kim" />
  <meta
    name="description"
    content="
              Computer science student. Web developer. Gopher.
        Welcome to my personal dev blog :D
    


    "
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.b2e0cb07595e3519ab1193bb421914e06c0e26b0cc561fef23b3c6131d4d2ffa.css"
      integrity="sha256-suDLB1leNRmrEZO7QhkU4GwOJrDMVh/vI7PGEx1NL/o="
      crossorigin="anonymous"
      type="text/css"
    />

  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css"
    integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.b1c4e6a10bdbab01f33fff9d78816ee68cf9a9a731f07668afd546a79924cb80.css"
    integrity="sha256-scTmoQvbqwHzP/&#43;deIFu5oz5qacx8HZor9VGp5kky4A="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.423dee17c62f55fa733a4ee13e00d523dfce88cc4f4ab4549a24ba36bd9de681.css"
    integrity="sha256-Qj3uF8YvVfpzOk7hPgDVI9/OiMxPSrRUmiS6Nr2d5oE="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.b7d54133b27e5b4de15245b8e143de3e8ed2d674c706137274cedc9953f31917.css"
    integrity="sha256-t9VBM7J&#43;W03hUkW44UPePo7S1nTHBhNydM7cmVPzGRc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />

  <link rel="canonical" href="https://jpoly1219.github.io/posts/reading-and-writing-different-files-in-go/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.738c0e3a493854876aeab9e2316fd43f1936aeeac4cc6b3e60bb26456dba72ad.js"
      integrity="sha256-c4wOOkk4VIdq6rniMW/UPxk2rurEzGs&#43;YLsmRW26cq0="
      crossorigin="anonymous"
    ></script>

  

  


  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reading and Writing Different Files in Go"/>
<meta name="twitter:description" content="Reading and writing files is an important feature of your program. Not all data is stored in the same memory space as your program, and sometimes you will need to share data with other programs or view it later with a different program. Storing your data in a file is a good way to achieve these goals. Today, we will look at how you can read from and write to commonly used file types."/>



  
  <meta property="og:title" content="Reading and Writing Different Files in Go" />
<meta property="og:description" content="Reading and writing files is an important feature of your program. Not all data is stored in the same memory space as your program, and sometimes you will need to share data with other programs or view it later with a different program. Storing your data in a file is a good way to achieve these goals. Today, we will look at how you can read from and write to commonly used file types." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jpoly1219.github.io/posts/reading-and-writing-different-files-in-go/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-07T09:05:39+09:00" />
<meta property="article:modified_time" content="2022-08-07T09:05:39+09:00" /><meta property="og:site_name" content="Hi, I&#39;m Jacob" />




  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "posts",
        "name": "Reading and Writing Different Files in Go",
        "headline": "Reading and Writing Different Files in Go",
        "alternativeHeadline": "",
        "description": "
      
        Reading and writing files is an important feature of your program. Not all data is stored in the same memory space as your program, and sometimes you will need to share data with other programs or view it later with a different program. Storing your data in a file is a good way to achieve these goals. Today, we will look at how you can read from and write to commonly used file types.


      


    ",
        "inLanguage": "en-us",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/jpoly1219.github.io\/posts\/reading-and-writing-different-files-in-go\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Jacob Kim"
        },
        "creator" : {
            "@type": "Person",
            "name": "Jacob Kim"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Jacob Kim"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Jacob Kim"
        },
        "copyrightYear" : "2022",
        "dateCreated": "2022-08-07T09:05:39.00Z",
        "datePublished": "2022-08-07T09:05:39.00Z",
        "dateModified": "2022-08-07T09:05:39.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Jacob Kim",
            "url": "https://jpoly1219.github.io/",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/jpoly1219.github.io\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
      ]

    ,
        "url" : "https:\/\/jpoly1219.github.io\/posts\/reading-and-writing-different-files-in-go\/",
        "wordCount" : "1601",
        "genre" : [ ],
        "keywords" : [ ]
    }
  </script>



</head>
<body
    
      class="body theme--light"

    
  >
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"

        
      ><div
  class="sidebar
    animated fadeInDown

  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/profile.png"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Hi, I&#39;m Jacob</a>
        </div>

      
      <div class="sidebar__introduction-description">
        <p>        Computer science student. Web developer. Gopher.<br />        Welcome to my personal dev blog :D<br />    </p>
      </div>
    </div>
    <ul class="sidebar__list">
      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Jacob Kim
        2022


      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.602bd2014468bd348112e2aa24f595c530d257a4ed6c335d7baaa6ac9a7ca6fb.js"
    integrity="sha256-YCvSAURovTSBEuKqJPWVxTDSV6TtbDNde6qmrJp8pvs="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"

        
      >
        <header class="header"><div
  class="
    animated fadeInDown

  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/posts/"
              
              title=""
              >Posts</a
            >
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>

        


      
        
        
          <li class="nav__list-item">
            <a
              
              href="/portfolio/"
              
              title=""
              >Portfolio</a
            >
          </li>

        


      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>

      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown

    "
  >
    
    <div class="post__content">
      <h1>Reading and Writing Different Files in Go</h1>
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                Sun, Aug 7, 2022


              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text">8-minute read</span>
          </li>
        </ul>

      <p>Reading and writing files is an important feature of your program. Not all data is stored in the same memory space as your program, and sometimes you will need to share data with other programs or view it later with a different program. Storing your data in a file is a good way to achieve these goals. Today, we will look at how you can read from and write to commonly used file types.</p>
<h3 id="ioreader-iowriter">io.Reader, io.Writer</h3>
<p>Have you ever wondered how Go can read and write so many different things? It&rsquo;s all thanks to these powerful interfaces. <code>io.Reader</code> describes anything that <code>Read</code>&rsquo;s, and <code>io.Writer</code> describes anything that <code>Write</code>&rsquo;s. Because this behavior can be replicated easily, anything that implements the <code>io.Reader</code> and <code>io.Writer</code> interfaces can be used for I/O operations. This means that you can plug and play different inputs and outputs. You could read from a CSV file and output it to JSON, or you could read from a <code>stdin</code> and write to CSV.</p>
<h3 id="csv">CSV</h3>
<p>A CSV file consists of rows of data, where each value is separated by a comma (hence the name comma separated values). CSV isn&rsquo;t the fastest format to read and write out there, but it is very versatile and can be understood by many other tools.</p>
<h4 id="reading">Reading</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;encoding/csv&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#e6db74">&#34;see-es-vee.csv&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">csv</span>.<span style="color:#a6e22e">NewReader</span>(<span style="color:#a6e22e">f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">records</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">ReadAll</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">records</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>[[id fruit color taste] [0 apple red sweet] [1 banana yellow sweet] [2 lemon yellow sour] [3 grapefruit red sour]]
</code></pre><p>Here is a very simple way to read data from a CSV file.</p>
<ul>
<li>
<p>We first open our file <code>see-es-vee.csv</code> and save that instance as <code>f</code>.</p>
</li>
<li>
<p>We want to close <code>f</code> once we are done. This is a good way to save memory. Although this is a short program and closing isn&rsquo;t all that necessary, it is good to get in the habit of doing so.</p>
</li>
<li>
<p><code>f</code> is of type <code>*os.File</code>, which implements the <code>io.Reader</code> interface. Therefore, we can pass <code>f</code> to <code>csv.NewReader</code>.</p>
</li>
<li>
<p>This returns a <code>csv.Reader</code> object <code>r</code>. <code>csv.Reader</code> is a type of <code>io.Reader</code> that specializes in reading CSV files.</p>
</li>
<li>
<p>Each line of a CSV file is called a <em>record</em>. So we can think of a CSV file as a <em>slice of records</em>. <code>r.ReadAll</code> returns this slice of records.</p>
</li>
<li>
<p>If we print <code>records</code>, we can see a 2D slice of rows.</p>
</li>
</ul>
<p>This is great, but what if we want to apply some operations to each record as we read? Fortunately, we can take a more granular approach.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#e6db74">&#34;see-es-vee.csv&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">csv</span>.<span style="color:#a6e22e">NewReader</span>(<span style="color:#a6e22e">f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">record</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Read</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">EOF</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">record</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Looks similar to the above, right? The part until creating <code>r</code> is the same. Let&rsquo;s see what happens next.</p>
<ul>
<li>
<p>We enter an infinite for loop, because we want to read the file line by line, and Go has no idea how long the file is.</p>
</li>
<li>
<p>We read each record using <code>r.Read</code>.</p>
</li>
<li>
<p>How do we know if we reached the end of the file? <code>r.Read</code> returns a special error called <code>io.EOF</code>. EOF stands for <em>end of file</em>. We catch this error first and tell our program to break out of the for loop once we reach the end.</p>
</li>
<li>
<p>For any other errors, you can just handle them the way you would normally do.</p>
</li>
<li>
<p>After we handle errors, we can do whatever we want with the record that has been extracted. Some ideas that I can think of are capitalization, rounding, comparing it to an arbitrary value, etc.</p>
</li>
</ul>
<p>Now let&rsquo;s look at how to write to a CSV file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;encoding/csv&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#e6db74">&#34;output.csv&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">w</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">csv</span>.<span style="color:#a6e22e">NewWriter</span>(<span style="color:#a6e22e">f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">records</span> <span style="color:#f92672">:=</span> [][]<span style="color:#66d9ef">string</span>{
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;id&#34;</span>, <span style="color:#e6db74">&#34;fruit&#34;</span>, <span style="color:#e6db74">&#34;color&#34;</span>, <span style="color:#e6db74">&#34;taste&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;apple&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#e6db74">&#34;sweet&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;banana&#34;</span>, <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#e6db74">&#34;sweet&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;lemon&#34;</span>, <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#e6db74">&#34;sour&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;grapefruit&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#e6db74">&#34;sour&#34;</span>},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">WriteAll</span>(<span style="color:#a6e22e">records</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>id,fruit,color,taste
0,apple,red,sweet
1,banana,yellow,sweet
2,lemon,yellow,sour
3,grapefruit,red,sour
</code></pre><p>Very simple and straightforward.</p>
<ul>
<li>
<p>We first need to create a file which we can dump our data into. We are going to call this <code>output.csv</code>. We just call <code>os.Create</code>, and save an instance of it as <code>f</code>.</p>
</li>
<li>
<p>Remember how we created a <code>csv.Reader</code> before? Here we are creating a <code>csv.Writer</code> object <code>w</code>. <code>csv.NewWriter</code> accepts the <code>io.Writer</code> interface, which <code>f</code> implements.</p>
</li>
<li>
<p>We prepare our data as a 2D slice of strings. We will call this <code>records</code>.</p>
</li>
<li>
<p>Finally, we just use <code>w.WriteAll</code> to write <code>records</code> to <code>output.csv</code>.</p>
</li>
</ul>
<h3 id="json">JSON</h3>
<p>Because Go is used extensively in web services, it has robust support for JSON. I wrote an entire post about reading and writing JSON files, so check that out for a more in-depth guide!</p>
<h4 id="reading-1">Reading</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">fruit</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Id</span>    <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Fruit</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;fruit&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Color</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;color&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Taste</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;taste&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#e6db74">&#34;jay-son.json&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dec</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewDecoder</span>(<span style="color:#a6e22e">f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// read opening bracket
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">dec</span>.<span style="color:#a6e22e">Token</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">dec</span>.<span style="color:#a6e22e">More</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fr</span> <span style="color:#a6e22e">fruit</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">dec</span>.<span style="color:#a6e22e">Decode</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">fr</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">fr</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// read closing bracket
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">dec</span>.<span style="color:#a6e22e">Token</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>{0 apple red sweet}
{1 banana yellow sweet}
{2 lemon yellow sour}
{3 grapefruit red sour}
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// jay-son.json
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>[
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">0</span>, <span style="color:#f92672">&#34;fruit&#34;</span>: <span style="color:#e6db74">&#34;apple&#34;</span>, <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#f92672">&#34;taste&#34;</span>: <span style="color:#e6db74">&#34;sweet&#34;</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#f92672">&#34;fruit&#34;</span>: <span style="color:#e6db74">&#34;banana&#34;</span>, <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#f92672">&#34;taste&#34;</span>: <span style="color:#e6db74">&#34;sweet&#34;</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#f92672">&#34;fruit&#34;</span>: <span style="color:#e6db74">&#34;lemon&#34;</span>, <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#f92672">&#34;taste&#34;</span>: <span style="color:#e6db74">&#34;sour&#34;</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#f92672">&#34;fruit&#34;</span>: <span style="color:#e6db74">&#34;grapefruit&#34;</span>, <span style="color:#f92672">&#34;color&#34;</span>: <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#f92672">&#34;taste&#34;</span>: <span style="color:#e6db74">&#34;sour&#34;</span>}
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>Here&rsquo;s a simple way to read JSON files. Normally, JSONs come in streams. That is, they come in a list of objects. Go handles streams via a decoder.</p>
<p>Let&rsquo;s take a look at this first:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">fruit</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Id</span>    <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Fruit</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;fruit&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Color</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;color&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Taste</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;taste&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This struct acts as a model. Because JSON can come in various shapes and sizes, you ideally want to have a model that mirrors the JSON&rsquo;s structure. The struct fields need to be public and should have a tag to the right which denotes what key it refers to. If you don&rsquo;t know what the JSON is going to look like in advance, Go will just use a <code>map[string]interface{}</code>.</p>
<ul>
<li>
<p>First, we open the file and save its instance to <code>f</code>. Don&rsquo;t forget to defer a call to close <code>f</code> later!</p>
</li>
<li>
<p>We create our decoder object <code>dec</code> using <code>json.NewDecoder</code>. Just like <code>csv.NewReader</code>, it accepts an <code>io.Reader</code>. You can start to see the power of interfaces - the details of reading are abstracted, and the workflow for reading is consistent across so many different file types.</p>
</li>
<li>
<p>Once <code>dec</code> is created, we can read our JSON. Just one problem, though. We need to make sure that we catch the opening and closing brackets using <code>dec.Token</code>. Not doing so is like trying to eat a subway sandwich with the wrapper still on. Bleh.</p>
</li>
<li>
<p>Just like how we read the CSV file line by line, we read the JSON stream object by object. We loop over <code>dec.More</code>, which returns <code>true</code> as long as there are objects still left to read.</p>
</li>
<li>
<p>We create an instance of <code>fruit</code> to store our object&rsquo;s data. Use <code>dec.Decode</code> to dump the object data to <code>f</code>. You can do what you want with this now.</p>
</li>
<li>
<p>After you are done reading, make sure to catch the closing bracket.</p>
</li>
</ul>
<h4 id="writing">Writing</h4>
<p>Writing to a JSON file is simple as well. We call this <em>encoding</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Fruit</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Id</span>    <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Fruit</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;fruit&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Color</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;color&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Taste</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;taste&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#e6db74">&#34;output.json&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">enc</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewEncoder</span>(<span style="color:#a6e22e">f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">apple</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Fruit</span>{<span style="color:#a6e22e">Id</span>: <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">Fruit</span>: <span style="color:#e6db74">&#34;apple&#34;</span>, <span style="color:#a6e22e">Color</span>: <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#a6e22e">Taste</span>: <span style="color:#e6db74">&#34;sweet&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">banana</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Fruit</span>{<span style="color:#a6e22e">Id</span>: <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">Fruit</span>: <span style="color:#e6db74">&#34;banana&#34;</span>, <span style="color:#a6e22e">Color</span>: <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#a6e22e">Taste</span>: <span style="color:#e6db74">&#34;sweet&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lemon</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Fruit</span>{<span style="color:#a6e22e">Id</span>: <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">Fruit</span>: <span style="color:#e6db74">&#34;lemon&#34;</span>, <span style="color:#a6e22e">Color</span>: <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#a6e22e">Taste</span>: <span style="color:#e6db74">&#34;sour&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">grapefruit</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Fruit</span>{<span style="color:#a6e22e">Id</span>: <span style="color:#ae81ff">3</span>, <span style="color:#a6e22e">Fruit</span>: <span style="color:#e6db74">&#34;grapefruit&#34;</span>, <span style="color:#a6e22e">Color</span>: <span style="color:#e6db74">&#34;red&#34;</span>, <span style="color:#a6e22e">Taste</span>: <span style="color:#e6db74">&#34;sour&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fruits</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">Fruit</span>{<span style="color:#a6e22e">apple</span>, <span style="color:#a6e22e">banana</span>, <span style="color:#a6e22e">lemon</span>, <span style="color:#a6e22e">grapefruit</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Encode</span>(<span style="color:#a6e22e">fruits</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>[{&#34;id&#34;:0,&#34;fruit&#34;:&#34;apple&#34;,&#34;color&#34;:&#34;red&#34;,&#34;taste&#34;:&#34;sweet&#34;},{&#34;id&#34;:1,&#34;fruit&#34;:&#34;banana&#34;,&#34;color&#34;:&#34;yellow&#34;,&#34;taste&#34;:&#34;sweet&#34;},{&#34;id&#34;:2,&#34;fruit&#34;:&#34;lemon&#34;,&#34;color&#34;:&#34;yellow&#34;,&#34;taste&#34;:&#34;sour&#34;},{&#34;id&#34;:3,&#34;fruit&#34;:&#34;grapefruit&#34;,&#34;color&#34;:&#34;red&#34;,&#34;taste&#34;:&#34;sour&#34;}]
</code></pre><p>This one&rsquo;s also very straightforward.</p>
<ul>
<li>
<p>We create a file named <code>output.json</code> to dump our data into.</p>
</li>
<li>
<p>We create a new encoder <code>enc</code> by using <code>json.NewEncoder</code>.</p>
</li>
<li>
<p>We prep our data, which is a slice of <code>Fruit</code> objects.</p>
</li>
<li>
<p>Finally, we encode this slice by using <code>enc.Encode</code>.</p>
</li>
</ul>
<h3 id="excel">Excel</h3>
<p>Go does not support reading and writing Excel files by default. However, there is a popular library called <code>qax-os/excelize</code> that helps you do this. If you take apart the source code, you can see that the package uses <code>*os.File</code> extensively, which is also an <code>io.Reader</code> and <code>io.Writer</code>. I think this shows the beauty of the <code>io.Reader</code> and <code>io.Writer</code> interfaces, because with a bit of tweaking, you can make a custom reader and writer that implements those interfaces, allowing you to support more file types.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Hopefully, this post served as a quick intro to reading and writing files in Go, and how powerful the <code>io.Reader</code> and <code>io.Writer</code> interfaces are. I think this is one of Go&rsquo;s beauty - interfaces allow for a very flexible and reusable code. There are certainly more files that we haven&rsquo;t covered in this post, but the general gist is the same: open the file, create a reader or a writer, and read/write from it. Thank you!</p>
<p>You can also read this post on <a href="https://medium.com/@jpoly1219/reading-and-writing-different-files-in-go-9c119edec51a">Medium</a> and <a href="https://dev.to/jpoly1219/reading-and-writing-different-files-in-go-4m3i">Dev.to</a>.</p>
</div>
    <div class="post__footer">
      

      
    </div>

    
  </div>


      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Jacob Kim
        2022


      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.602bd2014468bd348112e2aa24f595c530d257a4ed6c335d7baaa6ac9a7ca6fb.js"
    integrity="sha256-YCvSAURovTSBEuKqJPWVxTDSV6TtbDNde6qmrJp8pvs="
    crossorigin="anonymous"
  ></script></body>
</html>
